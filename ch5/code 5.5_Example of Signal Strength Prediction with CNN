#Copyright@Zhenhui Yuan, 2025

import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv1D, MaxPooling1D, Flatten, Dense
import numpy as np

# Generate synthetic dataset
# Features: [Bandwidth, User Density, Signal-to-Noise Ratio (SNR)]
# Labels: [Signal Strength (dBm)]
n_samples = 1000
X = np.random.rand(n_samples, 10, 3)  # 10 time steps, 3 features
Y = np.random.rand(n_samples, 1)  # Signal strength

# Define CNN model for signal strength prediction
model = Sequential([
    Conv1D(filters=64, kernel_size=3, activation='relu', input_shape=(10, 3)),
    MaxPooling1D(pool_size=2),
    Conv1D(filters=32, kernel_size=3, activation='relu'),
    Flatten(),
    Dense(64, activation='relu'),
    Dense(1, activation='linear')
])

# Compile the model
model.compile(optimizer='adam', loss='mse', metrics=['mae'])

# Train the model
model.fit(X, Y, epochs=20, batch_size=32, validation_split=0.2)

# Example prediction
sample_input = np.random.rand(1, 10, 3)
predicted_signal = model.predict(sample_input)
print(f"Predicted Signal Strength: {predicted_signal[0][0]:.2f} dBm")
